<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content='width=device-width, initial-scale=1' name=viewport> <title>Shaving The Blog Yak | DWF’s Journal</title> <link href='/feed.xml' rel=alternate title='Atom Feed' type='application/atom+xml'> <script type='application/ld+json'>
{"@type":"BlogPosting","url":"https://dwf.bigpencil.net/shaving-the-blog-yak/","datePublished":"2023-07-11","dateCreated":"2023-07-11","dateModified":"2023-11-15","headline":"Shaving The Blog Yak","abstract":"All the details about the update and clean up this blog's code.","keywords":["ruby","Middleman","HAML","Markdown","blog","CSS"],"author":{"@type":"Person","name":"Davis W. Frank","email":"dwfrank@gmail.com","url":"https://dwf.bigpencil.net/about_me","alumniOf":"University of Georgia","image":"https://dwf.bigpencil.net/images/dwf@2x-b89bef4d.png","sameAs":["https://www.linkedin.com/in/daviswfrank","https://github.com/infews","https://ruby.social/@dwfrank","https://www.threads.net/@dwfrank"]},"publisher":{"@type":"Person","name":"Davis W. Frank","email":"dwfrank@gmail.com","url":"https://dwf.bigpencil.net/about_me","alumniOf":"University of Georgia","image":"https://dwf.bigpencil.net/images/dwf@2x-b89bef4d.png","sameAs":["https://www.linkedin.com/in/daviswfrank","https://github.com/infews","https://ruby.social/@dwfrank","https://www.threads.net/@dwfrank"]},"articleBody":"\nI thought some would be interested in my blog “refresh” story. It’s got several yaks that needed everything from a light trim to a buzz-cut/rogaine special.  Like any good technical project rathole, I started with a dependency update…\n\nThis roughly 3-year-old site is a static site built with Middleman because I prefer Ruby, HAML, and Markdown. I wrote a few helpers, including a moderately interesting one for json+ld. I knew I wanted to do some restyling eventually. I needed to do a bundle update and to see what needed to change in the “guts” before getting to the markup/CSS.\n\nMiddleman updated to 4.5, HAML to 6.x, and I moved to Ruby 3.2.2. I then ran into a couple of intertwined problems with plugins and HAML. That led me to reconsider Middleman.\n\nBridgetown was the obvious next stop. But after a week of wrestling with its HAML support, I gave up. It wasn’t hard to migrate the content, but without full support of HAML components, I was building lots shim Liquid templates to keep most partials in HAML. It felt exactly like the type of work I would want to rip out later. It made more sense to me to stay with Middleman and fix the issues I’d found.\n\nThe dependency problems were with two plug-ins. I was using middleman-vcs-time for getting published times for feeds and json+ld. That plug-in has been archived, so I moved to File.mtime for now.\n\nNext was middleman-syntax which has some problems with HAML 6. Without a fix, I deferred this and jumped ahead.\n\nI had to make two changes for HAML 6 - succeed (thankfully) is gone, so I moved to string concatenation. I had a couple of places where I needed unescaped strings (thanks != !) (see again, json+ld).\n\nI knew I wanted to clean up my HTML to ASAP - As Semantic As Practical - so I did some research into classless CSS resets and settled on Holiday. It has some very nice, sensible defaults, making the kinds of changes I wanted to make clean and simple. This let me kill all of my old CSS, including my FontAwesome version-4-era self hosting, instead moving to their JS-based hosted free solution.\n\nNext up was a bunch of cleanup of layouts, HTML, and thus CSS. I had a few design changes I wanted to make that drove this. This was a lot of iterative tweaking, but I think my layouts and component partials are better factored than before. More deleted files!\n\nDuring the restyling, I found that even with Safari’s Responsive Developer Mode, the media queries aren’t quite right. This meant having the iPhone and iPad around with a cable for working the Console from my desktop for element inspection. You have to install the full Xcode to do this, but it is worth it.\n\nAll that done, I took a look at how I was customizing and configuring Middleman. I changed how I store and build my blog series (a custom collection). I do want these presented a little differently, and I had over-complicated them before. Now the series introduction page\\s are just in Markdown, like other articles/posts, and share a simple HAML template.\n\nNext up - the motivator for all of this work - was tweaking my resume. Before my resume was in HAML. I wanted to move this to (nearly) 100% Markdown to make maintenance easier. And I got there by making a custom HAML layout, which allowed me to move the social links (using Font Awesome) from HTML-in-Markdown to HAML.\n\nI was using RedCarpet for Markdown-to-HTML because it’s what middleman-syntax recommended. RedCarpet doesn’t support extended Markdown for HTML Definition Lists, which I use in my resume. Back to Kramdown (the Middleman default) for \u0026lt;dl\u0026gt;’s, installing [kramdown-parser-gfm][gfm] so I didn’t have to convert all my syntax-highlighting in articles to ~~~ (and change my brain), and finding a Pygments CSS file I liked. All pretty easy, but I’m still not thrilled with how the syntax highlighting looks for Markdown, so I may be revisiting this later.\n\nI version my resume with dates - this helps me personally and when talking with recruiters. Today this is manual and I wanted to make it automatic. Back to the resume HAML layout, where I added a line to shell out and get the last git commit date of the resume Markdown file with\n\ngit log -n 1 --pretty=format:%cs -- FILENAME\n\nThen I added a step to my rake-based build and publish that fails if there are uncommitted files. I should’ve done that ages ago.\n\nAfter all this work, I’m pretty happy with the result. I learned a bit. Solved some puzzles. Cleaned up some redundancy and poor factoring.\n\nI still have a handful of small things to do that I’ll work on as snacks here and there. A dark mode for CSS, fixing the most-recent-update date on articles using the git commit, some helper refactoring…\n\nWas this yak shaving? Absolutely. Was it fun? Also absolutely.\n","@context":"https://schema.org"}
</script> <link href='https://cdn.jsdelivr.net/npm/holiday.css@0.11.2' rel=stylesheet> <script crossorigin=anonymous src='https://kit.fontawesome.com/e76ee0328c.js'></script> <link href='/stylesheets/v23-87c5bb67.css' rel=stylesheet> <link href='/stylesheets/prism-laserwave-b0c76a64.css' rel=stylesheet> <script src='/js/prism-7933fd4a.js'></script> </head> <body> <nav class=menu> <ul> <li> <a class='' href='/'>Home</a> </li> <li> <span>Posts</span> <ul> <li> <a href='/series/the-cd-test'>The CD Test</a> </li> <li> <a href='/series/obsidian'>How I Obsidian</a> </li> <li> <a href='/series/rails-docker-nas'>Synology on Rails</a> </li> <li> <a href='/posts'>All Posts</a> </li> <li> <a href='/all_tags'>All Tags</a> </li> </ul> </li> <li> <a href='/notion'>Notion Templates</a> </li> <li> <a href='/about_me'>About Me</a> </li> </ul> </nav> <main class=''> <article> <h1> Shaving The Blog Yak </h1> <section class='header with_sharing'> <div class=info> <span class=date>11 July 2023</span> <span class=dash>&#8212;</span> <span class=duration>about a 4 minute read</span> </div> <div class=sharing> <button article='Shaving The Blog Yak' class=share style='display: none;' type=button> Share <i class='fa-solid fa-arrow-up-right-from-square'></i> </button> </div> </section> <section class=text> <p>I thought some would be interested in my blog “refresh” story. It’s got several yaks that needed everything from a light trim to a buzz-cut/rogaine special. Like any good technical project rathole, I started with a dependency update…</p> <p>This roughly 3-year-old site is a static site built with <a href="https://middlemanapp.com">Middleman</a> because I prefer Ruby, HAML, and Markdown. I wrote a few helpers, including a moderately interesting one for <a href="https://json-ld.org/">json+ld</a>. I knew I wanted to do some restyling eventually. I needed to do a <code>bundle update</code> and to see what needed to change in the “guts” before getting to the markup/CSS.</p> <p>Middleman updated to 4.5, HAML to 6.x, and I moved to Ruby 3.2.2. I then ran into a couple of intertwined problems with plugins and HAML. That led me to reconsider Middleman.</p> <p><a href="https://www.bridgetownrb.com/">Bridgetown</a> was the obvious next stop. But after a week of wrestling with its HAML support, I gave up. It wasn’t hard to migrate the content, but without full support of HAML components, I was building lots shim Liquid templates to keep most partials in HAML. It felt exactly like the type of work I would want to rip out later. It made more sense to me to stay with Middleman and fix the issues I’d found.</p> <p>The dependency problems were with two plug-ins. I was using <a href="https://github.com/AndrewKvalheim/middleman-vcs-time">middleman-vcs-time</a> for getting published times for feeds and json+ld. That plug-in has been archived, so I moved to <code>File.mtime</code> for now.</p> <p>Next was <a href="https://github.com/middleman/middleman-syntax">middleman-syntax</a> which has some problems with HAML 6. Without a fix, I deferred this and jumped ahead.</p> <p>I had to make two changes for HAML 6 - <code>succeed</code> (thankfully) is gone, so I moved to string concatenation. I had a couple of places where I needed unescaped strings (thanks <code>!=</code> !) (see again, <a href="https://json-ld.org/">json+ld</a>).</p> <p>I knew I wanted to clean up my HTML to ASAP - As Semantic As Practical - so I did some research into classless CSS resets and settled on <a href="https://holidaycss.js.org/">Holiday</a>. It has some very nice, sensible defaults, making the kinds of changes I wanted to make clean and simple. This let me kill all of my old CSS, including my <a href="https://fontawesome.com/">FontAwesome</a> version-4-era self hosting, instead moving to their JS-based hosted free solution.</p> <p>Next up was a bunch of cleanup of layouts, HTML, and thus CSS. I had a few design changes I wanted to make that drove this. This was a lot of iterative tweaking, but I think my layouts and component partials are better factored than before. More deleted files!</p> <p>During the restyling, I found that even with Safari’s Responsive Developer Mode, the media queries aren’t <em>quite</em> right. This meant having the iPhone and iPad around with a cable for working the Console from my desktop for element inspection. You have to install the full Xcode to do this, but it is worth it.</p> <p>All that done, I took a look at how I was customizing and configuring Middleman. I changed how I store and build my blog series (a custom collection). I do want these presented a little differently, and I had over-complicated them before. Now the series introduction page\s are just in Markdown, like other articles/posts, and share a simple HAML template.</p> <p>Next up - the motivator for all of this work - was tweaking my resume. Before my resume was in HAML. I wanted to move this to (nearly) 100% Markdown to make maintenance easier. And I got there by making a custom HAML layout, which allowed me to move the social links (using Font Awesome) from HTML-in-Markdown to HAML.</p> <p>I was using RedCarpet for Markdown-to-HTML because it’s what <code>middleman-syntax</code> recommended. RedCarpet doesn’t support extended Markdown for HTML Definition Lists, which I use in my resume. Back to Kramdown (the Middleman default) for <code>&lt;dl&gt;</code>’s, installing [kramdown-parser-gfm][gfm] so I didn’t have to convert all my syntax-highlighting in articles to <code>~~~</code> (and change my brain), and finding a Pygments CSS file I liked. All pretty easy, but I’m still not thrilled with how the syntax highlighting looks for Markdown, so I may be revisiting this later.</p> <p>I version my resume with dates - this helps me personally and when talking with recruiters. Today this is manual and I wanted to make it automatic. Back to the resume HAML layout, where I added a line to shell out and get the last git commit date of the resume Markdown file with</p> <p><code>git log -n 1 --pretty=format:%cs -- FILENAME</code></p> <p>Then I added a step to my <code>rake</code>-based build and publish that fails if there are uncommitted files. I should’ve done that ages ago.</p> <p>After all this work, I’m pretty happy with the result. I learned a bit. Solved some puzzles. Cleaned up some redundancy and poor factoring.</p> <p>I still have a handful of small things to do that I’ll work on as snacks here and there. A dark mode for CSS, fixing the most-recent-update date on articles using the git commit, some helper refactoring…</p> <p>Was this yak shaving? Absolutely. Was it fun? Also absolutely.</p> </section> <hr> <section class='about with_sharing'> <div class=tags> This article is tagged with <a href="/tags/ruby">ruby</a>, <a href="/tags/web-development">web development</a>, <a href="/tags/blog">blog</a>, and <a href="/tags/software">software</a>. </div> <div class=sharing> <button article='Shaving The Blog Yak' class=share style='display: none;' type=button> Share <i class='fa-solid fa-arrow-up-right-from-square'></i> </button> </div> </section> </article> </main> <footer class=site> <p class=small>© 2024 Davis W. Frank</p> </footer> <script async='' src='https://www.googletagmanager.com/gtag/js?id=G-SNXCW3490N'></script> <script>
window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date());
gtag('config', 'G-SNXCW3490N');
</script> </body> <script src='/js/share-aa52ba7b.js'></script> </html>